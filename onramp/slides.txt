                   Reclaim your
                     credits


                                      goo.gle/php-ws-ai
A number of developers are really excited for a hands-on workshop with their laptops. They're smiling and come from diverse background.
Table of Contents

     02         Reclaim credits
     20         AppMod Codelab Explained
     56         Goodies (Gemini API Key from AI studio, ..)




 Google Cloud                                  Proprietary & Confidential   2
Welcome to
today's
workshop!
Breathing new life into a legacy application
Take an old app from github
   ‚óè    Fork it
   ‚óè    Dockerize it
   ‚óè    Push to Cloud Run + CLoud SQL
   ‚óè    Create CI/CD
   ‚óè    Move cleartext passwords to Secret Manager
   ‚óè    Create Cloud Function to call Gemini
   ‚óè    Set up SLOs                                  https://codelabs.developers.google.c
   ‚óè    Security                                      om/codelabs/app-mod-workshop
   ‚óè    ‚Ä¶
You will use:



   01                                 02                                03
A personal                         A personal laptop                 The Chrome browser
Gmail account                      Ideally without restrictions on   Other browsers are supported,
School and business accounts       network access.                   but with a large group we want
cannot use today's workshop free                                     to minimize variations.
credits.
 Û∞é≤ Open this URL: üç∫                       Proprietary + ConÔ¨Ådential




https://trygcp.dev/e/wearedevs-2025-php-workshop
You will need to be signed in                                Proprietary + ConÔ¨Ådential




Google /dev/cloud day Zurich
                                Click on ‚ÄúSign in with Google‚Äù button
                                                                  Proprietary + ConÔ¨Ådential




Google /dev/cloud day Zurich




                 You should see a similar page. Click on this button.
                                                                         Proprietary + ConÔ¨Ådential




cloud-dev@gmail.com




                      Make sure that you are applying for the correct account




                          Click on ‚ÄúAccept and Continue‚Äù to proceed
If you see a Billing page, click on top left ‚ÄúGoogle Cloud‚Äù
until you see a Project selector on top left
                                                                      Proprietary + ConÔ¨Ådential




Go to console.cloud.google.com


                       Click on this dropdown menu




                                               ‚Äº If you can‚Äôt see this
                                               dropdown, click first on the
                                               colorful logo
                                                              Proprietary + ConÔ¨Ådential




Create a new project (skip if you already created one)




                                     Click on ‚ÄúNew Project‚Äù
                                                                          Proprietary + ConÔ¨Ådential




Creating a new project (skip if you already created one)

                                      Name your project, eg
                                      ‚ÄúGoogle Hackathon‚Äù


                                      üíµ Select ‚Äútrial billing
                                      account‚Äù (if it shows up*)

                                           (*) This is important, as it
                                           connects your project to
                                           your new 5üí≤wallet

                                     Select ‚ÄúNo Organization‚Äù
                                     (if Location field shows up)


                                       Click ‚ÄúCREATE‚Äù
Creating a new project (Skip if you already have one)




                                 If you can‚Äôt choose ‚ÄúNo
                                 organization‚Äù, you might be in
                                 trouble.
                                 One person from unimo.it was.
Check that your project is billed correctly
 1.   Search for Billing or go to https://console.cloud.google.com/billing

 2.   Click on My projects tab

 3.   Make sure your project is associated with the Google Cloud Platform Trial
      Billing Account
Open
Cloud Shell




              Note: It may take a
              minute or two to start
              your VM
                             Proprietary + ConÔ¨Ådential




If you don't have a
project set up yet, raise
your hand for a TA to help
you. Û∞¢ßÛ∞¢†
Thank you


Riccardo Carlesso
Developer Advocate
                Riccardo Carlesso
                Developer Advocate




PHP Amarcord
workshop
November 2024
                     Find this URL:
https://codelabs.developers.google.com/codelabs/app-mod-workshop

                           Or simply:




   Google ‚ÄúApp Mod Workshop‚Äù
                   Proprietary + Confidential




01

Does anyone remember
LAMP stacks?
                                                  Proprietary + Confidential




Û∞è¢ ‚ÄúPHP 5? Grande Giove!‚Äù

Hai una vecchia applicazione ferma
al 2010, con Java8, Rails, PHP o,
peggio ancora, ColdFusion?
Password in chiaro ovunque, codice
che fa arrossire‚Ä¶ e l‚Äôidea di
mostrarla a un collega ti terrorizza?



Grande Giove! üöÄ √à il momento di
trasformarla in una macchina degna      12   24

del futuro!
                                                                     Proprietary + Confidential




Û∞ßπ ‚ÄúPHP 5? Great Scott!‚Äù

"Quick Marty, we must go to the future immediately!
Jennifer's boss from 2015 wants to modernize a PHP
application left to us in 1885 and we need you!

There are clear-text passwords injected on Github by
a great-uncle of Biff, and the 2015‚Äôs Marty risks being
fired!

Don't worry, our friends from Google Cloud will be there
to help us, but the Tannen are always lurking!"




                                                           12   24
                                            Proprietary + Confidential




PHP 5.6 is ü™¶dead ?
An old app, in an unsupported language,
the last dev has left, CTO wants you to
add new features. Ever been there? You
company cares about an app, but nobody
knows how to put their hands on it?

How about we spend a few hours
modernizing it and bringing into the 21st
century?

üçº: 5.6.0 Aug 2014
ü™¶: 5.6     Dec 2018
                                                                      Proprietary + Confidential


Hey, I don‚Äôt want to learn PHP in 2025!
=> no: PHP 5.6 is perfect!




                    ‚ÄúMarty, you're not thinking 4th-dimensionally!‚Äù
Proprietary + Confidential
                              Proprietary + Confidential




Scary things!
I see cleartext passwords..
                                                Proprietary + Confidential


üß™[Lab] PHP Amarcord



üí°In this Lab,...

  ‚óè    Follow Ricc‚Äôs
       https://github.com/palladius/app-mod-w
       orkshop-set-by-step/ README



‚åõTime to complete: ~2-4h
                                                     Proprietary + Confidential




        ‚ôä PHP Amarcord:   What are we doing today?




üë§ You
                                                                          Proprietary + Confidential




PHP App (master)                         ‚ôä PHP Amarcord:   Existing app
github.com/gdgpescara/app-mod-workshop




   üë§ You
                                                                                                    Proprietary + Confidential




PHP App (master)                         ‚ôä PHP Amarcord:   0. Fork the original repo
github.com/gdgpescara/app-mod-workshop




  üç¥ Fork() repo




PHP Amarcord
github.com/YOUR_USER/app-mod-workshop



üç¥ Your Forked App




                                                                                       FUSE Mount




   üë§ You
                                                                                           Proprietary + Confidential




PHP App (master)                         ‚ôä PHP Amarcord:   1. Create DataBase
github.com/gdgpescara/app-mod-workshop




  üç¥ Fork() repo




PHP Amarcord
github.com/YOUR_USER/app-mod-workshop
                                                                                       ‚è≥
üç¥ Your Forked App




                                                                           MySQL
                                                                           Cloud SQL




   üë§ You
                                                                                       Proprietary + Confidential




PHP App (master)                         ‚ôä PHP Amarcord:   2. üöÄ Dockerize app
github.com/gdgpescara/app-mod-workshop




  üç¥ Fork() repo




PHP Amarcord
github.com/YOUR_USER/app-mod-workshop
                                                                    ?
üç¥ Your Forked App




                                                                           MySQL
                                                                           Cloud SQL




   üë§ You
                                                                                                                                       Proprietary + Confidential




PHP App (master)                                     ‚ôä PHP Amarcord:   3. üöÄ Deploy app to Cloud Run! App goes online: #gratification
github.com/gdgpescara/app-mod-workshop




  üç¥ Fork() repo
                                                                                   üíæ Storage, DB, ..



                                                                                                                      üñ• Cloud Run


PHP Amarcord                                                                                                               PHP App
github.com/YOUR_USER/app-mod-workshop
                                                                                                                           (DEV)
                                                                                                                           Cloud Run
üç¥ Your Forked App




                                                                                        MySQL
                                                                                        Cloud SQL




   üë§ You



                             üöÄ Pushes from localhost to Cloud Run
                                                                                                                         Proprietary + Confidential




PHP App (master)                         ‚ôä PHP Amarcord:   4. Clean up passwords: ENV + Secret Manager
github.com/gdgpescara/app-mod-workshop




  üç¥ Fork() repo
                                                                    üíæ Storage, DB, Secrets

                                                                        üîë Keys / üå± ENV
                                                                        Secret Manager
                                                                                                         üñ• Cloud Run


PHP Amarcord                                                                                                 PHP App
github.com/YOUR_USER/app-mod-workshop
                                                                                                             (DEV)
                                                                                                             Cloud Run
üç¥ Your Forked App




                                                                           MySQL
                                                                           Cloud SQL




   üë§ You
                                                                                                                                            Proprietary + Confidential




PHP App (master)                                    ‚ôä PHP Amarcord:         5. Set up Cloud Build pipeline: proper CI/CD!
github.com/gdgpescara/app-mod-workshop




                                                                                      üíæ Storage, DB, Secrets
                                                          CI/CD
                                                                                           üîë Keys / üå± ENV
                                                     Trigger to main                       Secret Manager
                                                     Cloud Build                                                            üñ• Cloud Run

                                            Builds to AR, deploys to CRun
PHP Amarcord                                                                                                                    PHP App
github.com/YOUR_USER/app-mod-workshop
                                                                                          üì¶ docker images                       (DEV)
                                                                                          Artifact Registry                     Cloud Run
üç¥ Your Forked App




                                                                                                                                PHP App
                                                                                              MySQL
                                                                                                                                (PROD)
                                                                                              Cloud SQL
                                                                                                                                Cloud Run

                                         git push origin main




   üë§ You
                                                                                                                                             Proprietary + Confidential




PHP App (master)                                 ‚ôä PHP Amarcord:         6. Adding Cloud Storage (GCS) and the ‚Äúmagic mount‚Äù
github.com/gdgpescara/app-mod-workshop




  üç¥ Fork() repo
                                                                                  üíæ Storage, DB, Secrets
                                                       CI/CD
                                                                                       üîë Keys / üå± ENV
                                                  Trigger to main                      Secret Manager
                                                  Cloud Build                                                            üñ• Cloud Run

                                         Builds to AR, deploys to CRun
PHP Amarcord                                                                                                                     PHP App
github.com/YOUR_USER/app-mod-workshop
                                                                                      üì¶ docker images                            (DEV)
                                                                                      Artifact Registry                          Cloud Run
üç¥ Your Forked App




                                                                                                                                 PHP App
                                                                                          MySQL
                                                                                                                                 (PROD)
                                                                                          Cloud SQL
                                                                                                                                 Cloud Run




                                                                                        Media üîä üèû
                                                                                        Cloud Storage                   FUSE Mount




   üë§ You
                                                                                                                                                    Proprietary + Confidential




PHP App (master)                                 ‚ôä PHP Amarcord:         7. Adding GCF+Gemini
github.com/gdgpescara/app-mod-workshop




  üç¥ Fork() repo
                                                                                  üíæ Storage, DB, Secrets
                                                       CI/CD
                                                                                      üîë Keys / üå± ENV
                                                  Trigger to main                     Secret Manager
                                                  Cloud Build                                               üñ• Cloud Run                      üêù APIs

                                         Builds to AR, deploys to CRun                                                                 Multimode Caption gen
PHP Amarcord                                                                                                        PHP App
github.com/YOUR_USER/app-mod-workshop                                                                                                  ‚ôä Vertex AI (Gemini)
                                                                                     üì¶ docker images                (DEV)
                                                                                     Artifact Registry              Cloud Run       'This üèû picture is about..'
üç¥ Your Forked App




                                                                                                                    PHP App             def generate_caption():
                                                                                         MySQL
                                                                                                                    (PROD)              Cloud Functions
                                                                                         Cloud SQL
                                                                                                                    Cloud Run
                                                                                                                                GCS -> f(x) -> ‚ôä Gemini -> SQL


                                                                                        Media üîä üèû
                                                                                        Cloud Storage      FUSE Mount




   üë§ You
                                                                                                                                                                      Proprietary + Confidential




PHP App (master)                                 ‚ôä PHP Amarcord:           8. Adding Operations: Service Level Objectives (SLOs)
github.com/gdgpescara/app-mod-workshop




  üç¥ Fork() repo
                                                                                     üíæ Storage, DB, Secrets
                                                       CI/CD
                                                                                         üîë Keys / üå± ENV
                                                  Trigger to main                        Secret Manager
                                                  Cloud Build                                                                 üñ• Cloud Run                      üêù APIs

                                         Builds to AR, deploys to CRun                                                                                   Multimode Caption gen
PHP Amarcord                                                                                                                          PHP App
github.com/YOUR_USER/app-mod-workshop                                                                                                                    ‚ôä Vertex AI (Gemini)
                                                                                        üì¶ docker images                               (DEV)
                                                                                        Artifact Registry                             Cloud Run       'This üèû picture is about..'
üç¥ Your Forked App




                                                                                                                                      PHP App             def generate_caption():
                                                                                            MySQL
                                                                                                                                      (PROD)              Cloud Functions
                                                                                            Cloud SQL
                                                                                                                                      Cloud Run
                                                           Ops                                                                                    GCS -> f(x) -> ‚ôä Gemini -> SQL

                                                    ‚è∞ SLO - Alerting
                                                    ‚¨ÜAvailability,Latenc                   Media üîä üèû
                                                    y                                      Cloud Storage                     FUSE Mount




   üë§ You
                                                                                                                                             Proprietary + Confidential




PHP App (master)                                                            ‚ôä PHP Amarcord v1.3
github.com/gdgpescara/app-mod-workshop




  üç¥ Fork() repo
                                                                           üíæ Storage, DB, Secrets
                                                       CI/CD
                                                                               üîë Keys / üå± ENV
                                                  Trigger to main              Secret Manager
                                                  Cloud Build                                        üñ• Cloud Run                      üêù APIs

                                         Builds to AR, deploys to CRun                                                          Multimode Caption gen
PHP Amarcord                                                                                                 PHP App
github.com/YOUR_USER/app-mod-workshop                                                                                           ‚ôä Vertex AI (Gemini)
                                                                              üì¶ docker images                (DEV)
                                                                              Artifact Registry              Cloud Run       'This üèû picture is about..'
üç¥ Your Forked App




                                                                                                             PHP App             def generate_caption():
                                                                                  MySQL
                                                                                                             (PROD)              Cloud Functions
                                                                                  Cloud SQL
                                                                                                             Cloud Run
                                                           Ops                                                           GCS -> f(x) -> ‚ôä Gemini -> SQL

                                                    ‚è∞ SLO - Alerting
                                                    ‚¨ÜAvailability,Latenc         Media üîä üèû
                                                    y                            Cloud Storage      FUSE Mount




   üë§ You
                                                                                                                                             Proprietary + Confidential




PHP App (master)                                                            ‚ôä PHP Amarcord v1.3
github.com/gdgpescara/app-mod-workshop




  üç¥ Fork() repo
                                                                           üíæ Storage, DB, Secrets
                                                       CI/CD
                                                                               üîë Keys / üå± ENV
                                                  Trigger to main              Secret Manager
                                                  Cloud Build                                        üñ• Cloud Run                      üêù APIs

                                         Builds to AR, deploys to CRun                                                          Multimode Caption gen
PHP Amarcord                                                                                                 PHP App
github.com/YOUR_USER/app-mod-workshop                                                                                           ‚ôä Vertex AI (Gemini)
                                                                              üì¶ docker images                (DEV)
                                                                              Artifact Registry              Cloud Run       'This üèû picture is about..'
üç¥ Your Forked App




                                                                                                             PHP App             def generate_caption():
                                                                                  MySQL
                                                                                                             (PROD)              Cloud Functions
                                                                                  Cloud SQL
                                                                                                             Cloud Run
                                                           Ops                                                           GCS -> f(x) -> ‚ôä Gemini -> SQL

                                                    ‚è∞ SLO - Alerting
                                                    ‚¨ÜAvailability,Latenc         Media üîä üèû
                                                    y                            Cloud Storage      FUSE Mount




   üë§ You
                                          Proprietary + Confidential




       Leaderboard


üèÜ If you want to win a prize check this
Workshop Leaderboard [optional]
Clean up
           Proprietary + Confidential
1. Stop your instance
                        Proprietary + Confidential
2. Delete your instance
                                                                                                                             Proprietary + Confidential




[optional]
  While this is not strictly necessary (a stopped istance will consume very little), you might want to delete an instance.
  If you have created an instance with ‚Äúprotection from deletion‚Äù, stopping it makes it actually harder to delete.
  If the deletion button won‚Äôt work for you, follow the steps in following slides, which can be summarized this way:

    1.    Restart the instance [if needed]
    2.    Remove the delete protection [if in place]
    3.    Stop
    4.    Click delete
2. Delete your instance (‚Öì)
                              Proprietary + Confidential




   1.   Click ‚Äúmodify‚Äù.
2. Delete your instance (2/3)
                                Proprietary + Confidential




  2. Remove protection:
2. Delete your instance (3/3)
                                Proprietary + Confidential




  3. Confirm.
 Optional:
1. enable ‚ÄúGemini for
   Google Cloud‚Äù
2. retrieve Gemini API Key
   from AI Studio.
[optional] Open Gemini AI side panel




                                       Gemini
                                       for
                                       Google
                                       Cloud
[optional] In the right panel, click on Enable




                                        Click here to Enable
                                        Gemini for Google
                                        Cloud API and start
                                        asking questions
Test Gemini for Google Cloud in console


                      Ask a question, e.g. ‚ÄúWhat is
                      Cloud Run?‚Äù or choose from the
                      sample queries shown. Submit
                      your prompt (arrow on the right)
                  1




                          Gemini for Google Cloud will
                      2
                          answer your query and display the
                          response.
Open the
Cloud Shell




              Note: It may take a
              minute or two to start
              your VM
Hack around‚Ä¶
Gemini API KEY Setup
(optional)
https://ai.google.dev/gemini-api/docs/api-key
                    2. Click to create key within that project

1. Select project
Tip: Usually it starts with ‚ÄúAIza‚Äù
Congratulations !
You are all set to start developing with Google Cloud
                  and invoking Gemini!
                     Find this URL:
https://codelabs.developers.google.com/codelabs/app-mod-workshop

                           Or simply:




   Google ‚ÄúApp Mod Workshop‚Äù
Feedback




           https://goo.gle/wad-ws-feedback
